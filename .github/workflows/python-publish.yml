    - name: Install deps
      shell: pwsh
      run: |
        python -m pip install --upgrade pip
        if (Test-Path requirements.txt) { pip install -r requirements.txt }
        pip install pyinstaller pillow

    - name: Ensure ICO (convert if only PNG exists)
      shell: pwsh
      run: |
        if (Test-Path .\release\mac\src\icon.ico) { exit 0 }
        if (Test-Path .\release\mac\src\icon.png) {
          python -c "from PIL import Image; Image.open(r'release/mac/src/icon.png').save(r'release/mac/src/icon.ico')"
        }

    - name: Build with PyInstaller (no .spec)
      shell: pwsh
      run: |
        $icon = Test-Path .\release\mac\src\icon.ico
        if ($icon) {
          pyinstaller .\release\mac\src\main_app.py --onefile --noconsole --icon .\release\mac\src\icon.ico
        } else {
          pyinstaller .\release\mac\src\main_app.py --onefile --noconsole
        }
